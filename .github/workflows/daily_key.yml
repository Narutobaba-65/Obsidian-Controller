name: Daily Key Rotator

on:
  schedule:
    - cron: '0 0 * * *' # Runs every day at Midnight (UTC)
  workflow_dispatch: # Allows you to click a button to run it manually

jobs:
  update-key:
    runs-on: ubuntu-latest
    steps:
      - name: Generate Random Key
        run: |
          # Generates a key like "Obsidian_Key_A9z2"
          NEW_KEY="Obsidian_Key_$(head /dev/urandom | tr -dc A-Za-z0-9 | head -c 4)"
          echo "New Key Generated: $NEW_KEY"
          
          # YOUR GIST ID IS INSERTED HERE 
          GIST_ID="60556bd13227bc28f59c54517264fe7e"
          
          # Update the Gist
          curl -L \
            -X PATCH \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GIST_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/gists/$GIST_ID \
            -d '{"files":{"Key.txt":{"content":"'"$NEW_KEY"'"}}}'
            
